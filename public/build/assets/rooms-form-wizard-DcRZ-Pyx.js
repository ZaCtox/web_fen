let a=1;const m=4;document.addEventListener("DOMContentLoaded",function(){if(console.log("DOM Loaded - Rooms Form Wizard"),document.querySelectorAll(".text-red-600, .text-red-400, .bg-red-50").length>0){console.log("Laravel validation errors detected");const n=document.querySelector(".hci-form-section .text-red-600, .hci-form-section .text-red-400");if(n){const r=n.closest(".hci-form-section");if(r&&r.dataset.step){const i=parseInt(r.dataset.step)||1;console.log("Going to step with error:",i),a=i}}}u(a),p(a);const o=document.querySelectorAll(".hci-input, .hci-select, .hci-textarea");console.log("Found inputs:",o.length),o.forEach(n=>{n.addEventListener("input",function(){h(this),S()}),n.addEventListener("blur",function(){w(this)})}),S();const t=document.getElementById("form-loading-overlay");t&&t.remove()});window.nextStep=function(){g()&&a<m&&(a++,u(a),p(a))};window.prevStep=function(){a>1&&(a--,u(a),p(a))};window.navigateToStep=function(e){(e<=a||g())&&(a=e,u(a),p(a))};window.cancelForm=function(){window.hasUnsavedChanges&&window.hasUnsavedChanges()?window.showUnsavedChangesModal(window.location.origin+"/rooms"):window.location.href=window.location.origin+"/rooms"};window.submitForm=function(){if(console.log("submitForm called"),!g()){console.log("Validation failed");return}if(console.log("Validation passed"),!document.getElementById("form-loading-overlay")){const o=document.createElement("div");o.id="form-loading-overlay",o.className="loading-overlay",o.innerHTML=`
            <div class="loading-overlay-content">
                <div class="inline-block w-12 h-12 animate-spin rounded-full border-4 border-solid border-[#4d82bc] border-r-transparent"></div>
                <p class="text-gray-700 dark:text-gray-300 font-medium">Guardando sala...</p>
            </div>
        `,document.body.appendChild(o)}const e=document.querySelector(".hci-form");console.log("Form found:",e),e?e.submit():(console.error("Form not found"),alert("Error: No se encontró el formulario"))};function u(e){document.querySelectorAll(".hci-form-section").forEach(n=>n.classList.remove("active"));const t=document.getElementById(E(e));t&&(t.classList.add("active"),t.scrollIntoView({behavior:"smooth",block:"start"})),window.updateWizardProgressSteps&&window.updateWizardProgressSteps(e)}function p(e){const o=document.getElementById("progress-bar"),t=document.getElementById("progress-percentage"),n=document.getElementById("current-step"),r=e/m*100;o&&(o.style.height=r+"%"),t&&(t.textContent=Math.round(r)+"%"),n&&(n.textContent=`Paso ${e} de ${m}`);const i=document.getElementById("prev-btn"),c=document.getElementById("next-btn"),s=document.getElementById("submit-btn");i&&(i.style.display=e>1?"flex":"none"),c&&s&&(e===m?(c.classList.add("hidden"),s.classList.remove("hidden")):(c.classList.remove("hidden"),s.classList.add("hidden")))}function E(e){return["basica","detalles","equipamiento","resumen"][e-1]}function g(){const o=document.getElementById(E(a)).querySelectorAll("input[required], select[required], textarea[required]");let t=!0;return console.log("Validating step",a),console.log("Required fields found:",o.length),o.forEach(n=>{console.log("Validating field:",n.name,"value:",n.value),!n.value||!n.value.trim()?(w(n),t=!1):h(n)}),t||x("Por favor, completa los campos requeridos antes de continuar."),console.log("Step validation result:",t),t}function x(e){let o=document.getElementById("step-error-message");o||(o=document.createElement("div"),o.id="step-error-message",o.className="hci-error-message",document.querySelector(".hci-container").insertBefore(o,document.querySelector(".hci-wizard-layout"))),o.innerHTML=`
        <div class="hci-error-content">
            <span class="hci-error-icon">⚠️</span>
            <span class="hci-error-text">${e}</span>
        </div>
    `,setTimeout(()=>o&&o.remove(),5e3)}function w(e){const o=e.checkValidity(),t=e.closest(".hci-field"),n=t==null?void 0:t.querySelector(".hci-field-error");if(o)h(e);else if(e.classList.add("border-red-500"),e.classList.remove("border-gray-300"),!n){const r=document.createElement("div");r.className="hci-field-error",r.textContent=e.validationMessage||"Este campo es requerido",t==null||t.appendChild(r)}}function h(e){e.classList.remove("border-red-500"),e.classList.add("border-gray-300");const o=e.closest(".hci-field"),t=o==null?void 0:o.querySelector(".hci-field-error");t&&t.remove()}function S(){var s,v,y,b;const e=((s=document.querySelector('input[name="name"]'))==null?void 0:s.value)||"",o=((v=document.querySelector('input[name="location"]'))==null?void 0:v.value)||"",t=((y=document.querySelector('input[name="capacity"]'))==null?void 0:y.value)||"",n=((b=document.querySelector('textarea[name="description"]'))==null?void 0:b.value)||"",r=d=>document.getElementById(d);r("resumen-name")&&(r("resumen-name").textContent=e||"No especificado"),r("resumen-location")&&(r("resumen-location").textContent=o||"No especificado"),r("resumen-capacity")&&(r("resumen-capacity").textContent=t||"No especificado"),r("resumen-description")&&(r("resumen-description").textContent=n||"No especificado");const i=[{name:"calefaccion",label:"Calefacción"},{name:"energia_electrica",label:"Energía Eléctrica"},{name:"existe_aseo",label:"Aseo Disponible"},{name:"plumones",label:"Plumones"},{name:"borrador",label:"Borrador"},{name:"pizarra_limpia",label:"Pizarra Limpia"},{name:"computador_funcional",label:"Computador Funcional"},{name:"cables_computador",label:"Cables del Computador"},{name:"control_remoto_camara",label:"Control Remoto de Cámara"},{name:"televisor_funcional",label:"Televisor Funcional"}],c=r("resumen-equipamiento");if(c){const d=i.filter(f=>{var l;return(l=document.querySelector(`input[name="${f.name}"]`))==null?void 0:l.checked});c.innerHTML="",d.length===0?c.textContent="No especificado":d.forEach(f=>{const l=document.createElement("span");l.className="inline-block px-2 py-1 rounded-md bg-[#c4dafa]/40 text-[#005187] text-xs",l.textContent=f.label,c.appendChild(l)})}}
