let o=1;const d=4;document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".hci-form-section .hci-field-error");if(e){const t=e.closest(".hci-form-section");t&&t.dataset.step&&(o=parseInt(t.dataset.step)||1)}l(o),u(o),document.querySelectorAll(".hci-input, .hci-select, .hci-textarea").forEach(t=>{t.addEventListener("blur",function(){x(this)}),t.addEventListener("input",function(){g(this),f()})}),f()});window.nextStep=function(){p()&&o<d&&(o++,l(o),u(o))};window.prevStep=function(){o>1&&(o--,l(o),u(o))};window.navigateToStep=function(e){(e<=o||p())&&(o=e,l(o),u(o))};window.cancelForm=function(){window.hasUnsavedChanges&&window.hasUnsavedChanges()?window.showUnsavedChangesModal(window.location.origin+"/staff"):window.location.href=window.location.origin+"/staff"};function l(e){document.querySelectorAll(".hci-form-section").forEach(r=>{r.classList.remove("active")});const t=document.getElementById(m(e));t&&(t.classList.add("active"),t.scrollIntoView({behavior:"smooth",block:"start"})),window.updateWizardProgressSteps&&window.updateWizardProgressSteps(e),m(e)==="resumen"&&f()}function u(e){const n=document.getElementById("progress-bar"),t=document.getElementById("progress-percentage"),r=document.getElementById("current-step"),c=e/d*100;n&&(n.style.height=c+"%"),t&&(t.textContent=Math.round(c)+"%"),r&&(r.textContent=`Paso ${e} de ${d}`);const s=document.getElementById("prev-btn"),i=document.getElementById("next-btn"),a=document.getElementById("submit-btn");s&&(s.style.display=e>1?"flex":"none"),i&&(i.style.display=e<d?"flex":"none"),a&&(a.style.display=e===d?"flex":"none")}function m(e){return["personal","contacto","adicional","resumen"][e-1]}function p(){const n=document.getElementById(m(o)).querySelectorAll("input[required], select[required], textarea[required]");let t=!0;return n.forEach(r=>{r.value.trim()?g(r):(x(r),t=!1)}),t||q("Por favor, completa todos los campos requeridos antes de continuar."),t}function q(e){let n=document.getElementById("step-error-message");n||(n=document.createElement("div"),n.id="step-error-message",n.className="hci-error-message",document.querySelector(".hci-container").insertBefore(n,document.querySelector(".hci-wizard-layout"))),n.innerHTML=`
        <div class="hci-error-content">
            <span class="hci-error-icon">⚠️</span>
            <span class="hci-error-text">${e}</span>
        </div>
    `,setTimeout(()=>{n&&n.remove()},5e3)}function x(e){const n=e.checkValidity(),t=e.closest(".hci-field"),r=t==null?void 0:t.querySelector(".hci-field-error");if(n)g(e);else if(e.classList.add("border-red-500"),e.classList.remove("border-gray-300"),!r){const c=document.createElement("div");c.className="hci-field-error",c.textContent=e.validationMessage||"Este campo es requerido",t==null||t.appendChild(c)}}function g(e){e.classList.remove("border-red-500"),e.classList.add("border-gray-300");const n=e.closest(".hci-field"),t=n==null?void 0:n.querySelector(".hci-field-error");t&&t.remove()}function f(){var h,S,w,E,b;const e=((h=document.querySelector('input[name="nombre"]'))==null?void 0:h.value)||"",n=((S=document.querySelector('input[name="cargo"]'))==null?void 0:S.value)||"",t=((w=document.querySelector('input[name="email"]'))==null?void 0:w.value)||"",r=((E=document.querySelector('input[name="telefono"]'))==null?void 0:E.value)||"",c=((b=document.querySelector('input[name="anexo"]'))==null?void 0:b.value)||"No especificado",s=document.getElementById("resumen-nombre"),i=document.getElementById("resumen-cargo"),a=document.getElementById("resumen-email"),y=document.getElementById("resumen-telefono"),v=document.getElementById("resumen-anexo");s&&(s.textContent=e||"No especificado"),i&&(i.textContent=n||"No especificado"),a&&(a.textContent=t||"No especificado"),y&&(y.textContent=r||"No especificado"),v&&(v.textContent=c)}window.submitForm=function(){if(p()){if(!document.getElementById("form-loading-overlay")){const e=document.createElement("div");e.id="form-loading-overlay",e.className="loading-overlay",e.innerHTML=`
                <div class="loading-overlay-content">
                    <div class="inline-block w-12 h-12 animate-spin rounded-full border-4 border-solid border-[#4d82bc] border-r-transparent"></div>
                    <p class="text-gray-700 dark:text-gray-300 font-medium">Procesando...</p>
                </div>
            `,document.body.appendChild(e)}document.querySelector(".hci-form").submit()}};
