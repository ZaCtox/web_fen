let r=1;const m=4;document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".hci-form-section .hci-field-error, .hci-form-section .text-red-600, .hci-form-section .border-red-500");if(e){const t=e.closest(".hci-form-section");t&&t.dataset.step&&(r=parseInt(t.dataset.step)||1)}u(r),p(r),document.querySelectorAll(".hci-input, .hci-select, .hci-textarea").forEach(t=>{t.addEventListener("input",function(){y(this),S()}),t.addEventListener("blur",function(){E(this)})}),S()});window.nextStep=function(){h()&&r<m&&(r++,u(r),p(r))};window.prevStep=function(){r>1&&(r--,u(r),p(r))};window.navigateToStep=function(e){(e<=r||h())&&(r=e,u(r),p(r))};window.cancelForm=function(){window.hasUnsavedChanges&&window.hasUnsavedChanges()?window.showUnsavedChangesModal(window.location.origin+"/rooms"):window.location.href=window.location.origin+"/rooms"};window.submitForm=function(){if(h()){if(!document.getElementById("form-loading-overlay")){const e=document.createElement("div");e.id="form-loading-overlay",e.className="loading-overlay",e.innerHTML=`
                <div class="loading-overlay-content">
                    <div class="inline-block w-12 h-12 animate-spin rounded-full border-4 border-solid border-[#4d82bc] border-r-transparent"></div>
                    <p class="text-gray-700 dark:text-gray-300 font-medium">Procesando...</p>
                </div>
            `,document.body.appendChild(e)}document.querySelector(".hci-form").submit()}};function u(e){document.querySelectorAll(".hci-form-section").forEach(c=>c.classList.remove("active"));const t=document.getElementById(w(e));t&&(t.classList.add("active"),t.scrollIntoView({behavior:"smooth",block:"start"})),window.updateWizardProgressSteps&&window.updateWizardProgressSteps(e)}function p(e){const n=document.getElementById("progress-bar"),t=document.getElementById("progress-percentage"),c=document.getElementById("current-step"),o=e/m*100;n&&(n.style.height=o+"%"),t&&(t.textContent=Math.round(o)+"%"),c&&(c.textContent=`Paso ${e} de ${m}`);const d=document.getElementById("prev-btn"),i=document.getElementById("next-btn"),a=document.getElementById("submit-btn");d&&(d.style.display=e>1?"flex":"none"),i&&a&&(e===m?(i.classList.add("hidden"),a.classList.remove("hidden")):(i.classList.remove("hidden"),a.classList.add("hidden")))}function w(e){return["basica","detalles","equipamiento","resumen"][e-1]}function h(){const n=document.getElementById(w(r)).querySelectorAll("input[required], select[required], textarea[required]");let t=!0;return n.forEach(c=>{c.value.trim()?y(c):(E(c),t=!1)}),t||x("Por favor, completa los campos requeridos antes de continuar."),t}function x(e){let n=document.getElementById("step-error-message");n||(n=document.createElement("div"),n.id="step-error-message",n.className="hci-error-message",document.querySelector(".hci-container").insertBefore(n,document.querySelector(".hci-wizard-layout"))),n.innerHTML=`
        <div class="hci-error-content">
            <span class="hci-error-icon">⚠️</span>
            <span class="hci-error-text">${e}</span>
        </div>
    `,setTimeout(()=>n&&n.remove(),5e3)}function E(e){const n=e.checkValidity(),t=e.closest(".hci-field"),c=t==null?void 0:t.querySelector(".hci-field-error");if(n)y(e);else if(e.classList.add("border-red-500"),e.classList.remove("border-gray-300"),!c){const o=document.createElement("div");o.className="hci-field-error",o.textContent=e.validationMessage||"Este campo es requerido",t==null||t.appendChild(o)}}function y(e){e.classList.remove("border-red-500"),e.classList.add("border-gray-300");const n=e.closest(".hci-field"),t=n==null?void 0:n.querySelector(".hci-field-error");t&&t.remove()}function S(){var a,v,g,b;const e=((a=document.querySelector('input[name="name"]'))==null?void 0:a.value)||"",n=((v=document.querySelector('input[name="location"]'))==null?void 0:v.value)||"",t=((g=document.querySelector('input[name="capacity"]'))==null?void 0:g.value)||"",c=((b=document.querySelector('textarea[name="description"]'))==null?void 0:b.value)||"",o=l=>document.getElementById(l);o("resumen-name")&&(o("resumen-name").textContent=e||"No especificado"),o("resumen-location")&&(o("resumen-location").textContent=n||"No especificado"),o("resumen-capacity")&&(o("resumen-capacity").textContent=t||"No especificado"),o("resumen-description")&&(o("resumen-description").textContent=c||"No especificado");const d=[{name:"calefaccion",label:"Calefacción"},{name:"energia_electrica",label:"Energía Eléctrica"},{name:"existe_aseo",label:"Aseo Disponible"},{name:"plumones",label:"Plumones"},{name:"borrador",label:"Borrador"},{name:"pizarra_limpia",label:"Pizarra Limpia"},{name:"computador_funcional",label:"Computador Funcional"},{name:"cables_computador",label:"Cables del Computador"},{name:"control_remoto_camara",label:"Control Remoto de Cámara"},{name:"televisor_funcional",label:"Televisor Funcional"}],i=o("resumen-equipamiento");if(i){const l=d.filter(f=>{var s;return(s=document.querySelector(`input[name="${f.name}"]`))==null?void 0:s.checked});i.innerHTML="",l.length===0?i.textContent="No especificado":l.forEach(f=>{const s=document.createElement("span");s.className="inline-block px-2 py-1 rounded-md bg-[#c4dafa]/40 text-[#005187] text-xs",s.textContent=f.label,i.appendChild(s)})}}
