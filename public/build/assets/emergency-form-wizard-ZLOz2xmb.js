let c=1;const d=3;document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".hci-form-section"),document.querySelectorAll(".hci-progress-step-vertical"),document.getElementById("progress-bar"),document.getElementById("progress-percentage"),document.getElementById("current-step"),i(1),a(1),document.querySelectorAll(".hci-input, .hci-select, .hci-textarea").forEach(t=>{t.addEventListener("blur",function(){f(this)}),t.addEventListener("input",function(){l(this),g()})})});window.nextStep=function(){u()&&c<d&&(c++,i(c),a(c))};window.prevStep=function(){c>1&&(c--,i(c),a(c))};window.navigateToStep=function(e){(e<=c||u())&&(c=e,i(c),a(c))};window.cancelForm=function(){confirm("¿Estás seguro de que quieres cancelar? Se perderán todos los datos ingresados.")&&(window.location.href=window.location.origin+"/emergencies")};function i(e){const t=document.querySelectorAll(".hci-form-section"),r=document.querySelectorAll(".hci-progress-step-vertical");t.forEach(o=>{o.classList.remove("active")});const n=document.getElementById(m(e));n&&(n.classList.add("active"),n.scrollIntoView({behavior:"smooth",block:"start"})),r.forEach((o,s)=>{s+1<=e?(o.classList.add("completed"),o.classList.add("active")):(o.classList.remove("completed"),o.classList.remove("active"))})}function a(e){const t=document.getElementById("progress-bar"),r=document.getElementById("progress-percentage"),n=document.getElementById("current-step"),o=e/d*100;t&&(t.style.height=o+"%"),r&&(r.textContent=Math.round(o)+"%"),n&&(n.textContent=`Paso ${e} de ${d}`)}function m(e){return["basica","mensaje","resumen"][e-1]}function u(){const t=document.getElementById(m(c)).querySelectorAll("input[required], select[required], textarea[required]");let r=!0;return t.forEach(n=>{n.value.trim()?l(n):(f(n),r=!1)}),r||p("Por favor, completa todos los campos requeridos antes de continuar."),r}function p(e){let t=document.getElementById("step-error-message");t||(t=document.createElement("div"),t.id="step-error-message",t.className="hci-error-message",document.querySelector(".hci-container").insertBefore(t,document.querySelector(".hci-wizard-layout"))),t.innerHTML=`
        <div class="hci-error-content">
            <span class="hci-error-icon">⚠️</span>
            <span class="hci-error-text">${e}</span>
        </div>
    `,setTimeout(()=>{t&&t.remove()},5e3)}function f(e){const t=e.checkValidity(),r=e.closest(".hci-field"),n=r==null?void 0:r.querySelector(".hci-field-error");if(t)l(e);else if(e.classList.add("border-red-500"),e.classList.remove("border-gray-300"),!n){const o=document.createElement("div");o.className="hci-field-error",o.textContent=e.validationMessage||"Este campo es requerido",r==null||r.appendChild(o)}}function l(e){e.classList.remove("border-red-500"),e.classList.add("border-gray-300");const t=e.closest(".hci-field"),r=t==null?void 0:t.querySelector(".hci-field-error");r&&r.remove()}function g(){var o,s;const e=((o=document.querySelector('input[name="title"]'))==null?void 0:o.value)||"",t=((s=document.querySelector('textarea[name="message"]'))==null?void 0:s.value)||"",r=document.getElementById("resumen-titulo"),n=document.getElementById("resumen-mensaje");r&&(r.textContent=e||"No especificado"),n&&(n.textContent=t||"No especificado")}window.submitForm=function(){u()&&document.querySelector(".hci-form").submit()};
