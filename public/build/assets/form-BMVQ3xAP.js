document.addEventListener("DOMContentLoaded",()=>{const a=window.PERIODS||[],m={1:"I",2:"II",3:"III",4:"IV",5:"V",6:"VI"},i=document.getElementById("anio"),t=document.getElementById("numero"),u=document.getElementById("period_id");let r=null;function c(){const n=i.value;if(t.innerHTML='<option value="">-- Selecciona un trimestre --</option>',!n)return;a.filter(e=>e.anio==n).map(e=>({numero:e.numero,id:e.id})).sort((e,o)=>e.numero-o.numero).forEach(e=>{const o=document.createElement("option");o.value=e.numero,o.textContent=`Trimestre ${m[e.numero]||e.numero}`,t.appendChild(o)}),r&&(t.value=r,r=null),s()}function s(){const n=i.value,d=t.value,e=a.find(o=>o.anio==n&&o.numero==d);u.value=e?e.id:""}i.addEventListener("change",()=>{c()}),t.addEventListener("change",s);const l=u.value;if(l){const n=a.find(d=>d.id==l);n&&(i.value=n.anio,r=n.numero,c())}});
