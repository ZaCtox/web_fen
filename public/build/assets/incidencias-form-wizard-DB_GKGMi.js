let r=1;const d=4;document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".hci-form-section"),document.querySelectorAll(".hci-progress-step"),document.getElementById("progress-bar"),document.getElementById("progress-percentage"),document.getElementById("current-step"),s(1),a(1),document.querySelectorAll(".hci-input, .hci-select, .hci-textarea").forEach(t=>{t.addEventListener("blur",function(){L(this)}),t.addEventListener("input",function(){l(this),C()})})});window.nextStep=function(){u()&&r<d&&(r++,s(r),a(r))};window.prevStep=function(){r>1&&(r--,s(r),a(r))};window.navigateToStep=function(e){(e<=r||u())&&(r=e,s(r),a(r))};window.cancelForm=function(){window.hasUnsavedChanges&&window.hasUnsavedChanges()?window.showUnsavedChangesModal(window.location.origin+"/incidencias"):window.location.href=window.location.origin+"/incidencias"};function s(e){const t=document.querySelectorAll(".hci-form-section"),n=document.querySelectorAll(".hci-progress-step-vertical");t.forEach(o=>{o.classList.remove("active")});const c=document.getElementById(x(e));c&&(c.classList.add("active"),c.scrollIntoView({behavior:"smooth",block:"start"})),n.forEach((o,i)=>{i+1<=e?(o.classList.add("completed"),o.classList.add("active")):(o.classList.remove("completed"),o.classList.remove("active"))})}function a(e){const t=document.getElementById("progress-bar"),n=document.getElementById("progress-percentage"),c=document.getElementById("current-step"),o=e/d*100;t&&(t.style.height=o+"%"),n&&(n.textContent=Math.round(o)+"%"),c&&(c.textContent=`Paso ${e} de ${d}`)}function x(e){return["basica","ubicacion","evidencia","resumen"][e-1]}function u(){const t=document.getElementById(x(r)).querySelectorAll("input[required], select[required], textarea[required]");let n=!0;return t.forEach(c=>{c.value.trim()?l(c):(L(c),n=!1)}),n||b("Por favor, completa todos los campos requeridos antes de continuar."),n}function b(e){let t=document.getElementById("step-error-message");t||(t=document.createElement("div"),t.id="step-error-message",t.className="hci-error-message",document.querySelector(".hci-container").insertBefore(t,document.querySelector(".hci-wizard-layout"))),t.innerHTML=`
        <div class="hci-error-content">
            <span class="hci-error-icon">⚠️</span>
            <span class="hci-error-text">${e}</span>
        </div>
    `,setTimeout(()=>{t&&t.remove()},5e3)}function L(e){const t=e.checkValidity(),n=e.closest(".hci-field"),c=n==null?void 0:n.querySelector(".hci-field-error");if(t)l(e);else if(e.classList.add("border-red-500"),e.classList.remove("border-gray-300"),!c){const o=document.createElement("div");o.className="hci-field-error",o.textContent=e.validationMessage||"Este campo es requerido",n==null||n.appendChild(o)}}function l(e){e.classList.remove("border-red-500"),e.classList.add("border-gray-300");const t=e.closest(".hci-field"),n=t==null?void 0:t.querySelector(".hci-field-error");n&&n.remove()}function C(){var h,y,v,S,E,w,q,I,B;const e=((h=document.querySelector('input[name="titulo"]'))==null?void 0:h.value)||"",t=((y=document.querySelector('textarea[name="descripcion"]'))==null?void 0:y.value)||"",n=((E=(S=(v=document.querySelector('select[name="room_id"]'))==null?void 0:v.selectedOptions)==null?void 0:S[0])==null?void 0:E.text)||"",c=((I=(q=(w=document.querySelector('input[name="imagen"]'))==null?void 0:w.files)==null?void 0:q[0])==null?void 0:I.name)||"",o=((B=document.querySelector('input[name="nro_ticket"]'))==null?void 0:B.value)||"",i=document.getElementById("summary-titulo"),m=document.getElementById("summary-descripcion"),p=document.getElementById("summary-sala"),f=document.getElementById("summary-imagen"),g=document.getElementById("summary-ticket");i&&(i.textContent=e||"No especificado"),m&&(m.textContent=t||"No especificado"),p&&(p.textContent=n||"No especificado"),f&&(f.textContent=c||"Sin imagen"),g&&(g.textContent=o||"Sin ticket")}window.submitForm=function(){u()&&document.querySelector(".hci-form").submit()};
